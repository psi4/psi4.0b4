#! Evaluates the PBE energy on top of a HF density, and vice versa

refE_HF_minimum  = -128.5351230509848790 # TEST
refE_PBE_posthf  = -128.8496460554293321 # TEST

refE_PBE_minimum = -128.8567814397552809 # TEST
refE_HF_postpbe  = -128.5275358115971471 # TEST

molecule {
 0 1
 Ne
}

# General settings
set basis pcseg-2
set scf_type pk
set df_scf_guess false
set dft_radial_points 250
set dft_spherical_points 974
set dft_pruning_scheme none
set maxiter 100

# Run Hartree-Fock
set d_convergence 1e-9
set e_convergence 1e-9
E_HF_minimum = energy('scf')

# Run PBE single-shot
set guess read
set maxiter 0
E_PBE_posthf = energy('pbe')

# Run PBE self-consistent energy
set maxiter 100
E_PBE_minimum = energy('pbe')

# Run HF single-shot
set maxiter 0
E_HF_postpbe = energy('scf')

compare_values(refE_HF_minimum,  E_HF_minimum,  8, "HF energy")           # TEST
compare_values(refE_PBE_posthf,  E_PBE_posthf,  8, "PBE energy, post-HF") # TEST
compare_values(refE_PBE_minimum, E_PBE_minimum, 8, "PBE energy")          # TEST
compare_values(refE_HF_postpbe,  E_HF_postpbe,  8, "HF energy, post-PBE") # TEST

